---
layout:     post
title:      "EXCEL理财相关公式"
date:       2017-03-08 22:20:00 +0800
author:     "DongYeo"
header-img: "img/post-bg-02.jpg"
tags: ["理财"]
---

## 前言

前一阵子，研究了一下理财相关的知识，开始定投几个基金，今天突然想到那几天还学了几个计算投资相关的公式，并且在excel上可以方便的使用，今天记录一下，便于以后查询。


## 公式汇总

- PMT计算根据固定付款额和固定利率贷款的付款

- NPER计算基于常规，一笔投资的付款期数固定付款额和固定利率

- PV返回一笔投资的现值。现值是一系列未来支出的总金额现在

- FV返回根据定期固定付款和固定利率而定的投资的未来值

### PMT

- PMT适用于计算固定付款数和贷款额度下的每次付款额度的公式，说白了，就是计算一定利率下你的分期付款数
- 函数：PMT(rate, nper, pv, [fv], [type])

参数|解释
---|---
rate|必需，贷款利率。
Nper |  必需， 该项贷款的付款总数。
pv   | 必需，现值，或一系列未来付款额现在所值的总额，也叫本金。
fv   | 可选， 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（零），即贷款的未来值是 0。
type |   可选， 数字 0（零）或 1 指示支付时间。

- 例子

  - 计算每月付款还清信用卡债务的付款：

  假设欠款为 5,400 美元，年利率为 17%。 在还清债务期间，不再使用信用卡购买任何东西。
  使用函数 PMT(rate,NPER,PV)
  =PMT(17%/12,2*12,5400)
  结果是每月付款额为 266.99 美元在两年内还清债务。
  Rate 参数是贷款期利率。例如，在此公式年利率 17%除以 12，一年中的月份数。
  NPER 参数 2*12 指的是贷款的总付款期数。
  PV 或现值参数是 5400。

  - 计算每月按揭付款：

  假设房屋价值 180,000 美元，年利率 5%，采用 30 年按揭付款。
  使用函数 PMT(rate,NPER,PV)
  =PMT(5%/12,30*12,180000)
  结果是每月付款 （不含保险和税） 为 966.28 美元。
  Rate 参数是 5%除以一年的 12 个月。
  NPER 参数是 30*12，即 30 年按揭付款，每年付款 12 期（按月付款）。
  PV 参数是 180000（贷款的现值）。
  了解如何保存梦想度假每个月

  - 从现在起，您想要为一次将花费 8,500 美元的度假储蓄三年。 储蓄的年利率是 1.5%：

  使用函数 PMT(rate,NPER,PV,FV)
  =PMT(1.5%/12,3*12,0,8500)
  若要在三年内储蓄 8500 美元需要储蓄 230.99 美元每个月的三年。
  Rate 参数是 1.5%除以 12，一年中的月份数。
  NPER 参数是 3*12，即三年储蓄，每年储蓄 12 期（按月储蓄）。
  PV（现值）为 0，因为帐户是从零开始储蓄。
  您希望储蓄的 FV（未来值）是 8,500 美元。

### PV

- 返回一笔投资的现值。现值是一系列未来支出的总金额现在。
- 函数：PV(rate, nper, pmt, [fv], [type])

参数|说明
---|----
Rate    |必需。 各期利率。 例如，如果您获得年利率为 10% 的汽车贷款，并且每月还款一次，则每月的利率为 10%/12（即 0.83%）。 您需要在公式中输入 10%/12（即 0.83%）或 0.0083 作为利率。
Nper   | 必需。 年金的付款总期数。 例如，如果您获得为期四年的汽车贷款，每月还款一次，则贷款期数为 4*12（即 48）期。 您需要在公式中输入 48 作为 nper。
Pmt    |必需。 每期的付款金额，在年金周期内不能更改。 通常，pmt 包括本金和利息，但不含其他费用或税金。 例如，对于金额为 ￥100,000、利率为 12% 的四年期汽车贷款，每月付款为 ￥2633.30。 您需要在公式中输入 -2633.30 作为 pmt。 如果省略 pmt，则必须包括 fv 参数。
fv    |可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。 例如，如果要在 18 年中为支付某个特殊项目而储蓄 ￥500,000，则 ￥500,000 就是未来值。 然后，您可以对利率进行保守的猜测，并确定每月必须储蓄的金额。 如果省略 fv，则必须包括 pmt 参数。
type    |可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。

- 例子

  - 现在，假设您保存 8500 美元度假三年，并想知道多少您需要在您的帐户在每月 175.00 美元保留期，按月储蓄存款。PV 函数将计算多少的开户将产生的未来值：

  使用函数 PV(rate,NPER,PMT,FV)
  =PV(1.5%/12,3*12,-175,8500)
  $ 1，969.62 初始存款将才能能够 175.00 美元每月并在三年内结尾 8500 美元。
  Rate 参数是 1.5%/12。
  NPER 参数是 3*12（即三年储蓄，每年储蓄 12 期，按月储蓄）。
  PMT 是-175 （您需付出 175 美元每月）。
  FV （未来值） 是 8500。

  - 计算预付定金

  假设您想购买一辆价值 19,000 美元的汽车，年利率为 2.9%，三年按揭付款。 您希望每月付款 350 美元，因此您需要计算出预付定金。 在此公式中，PV 函数的结果是贷款额，从购买价格中减去它即为预付定金。
  使用函数 PV(rate,NPER,PMT)
  = 19000 PV(2.9%/12, 3*12,-350)
  必需的向下付款为 6，946.48 美元
  公式首先列出购买价格 19,000 美元。 将从购买价格中减去 PV 函数的结果。
  Rate 参数是 2.9% 除以 12。
  NPER 参数是 3*12（即三年付款，每年付款 12 期，按月付款）。
  PMT 是 -350（您每月需付出 350 美元）。


### NPER

- 计算基于常规，一笔固定付款额和固定利率投资的付款期数
- 函数：NPER(rate,pmt,pv,[fv],[type])

参数|说明
---|---
Rate  |  必需。 各期利率。
Pmt    |必需。 各期所应支付的金额，在整个年金期间保持不变。 通常 pmt 包括本金和利息，但不包括其他费用或税款。
Pv   | 必需。 现值，或一系列未来付款的当前值的累积和。
Fv   | 可选。 未来值，或在最后一次付款后希望得到的现金余额。 如果省略 fv，则假定其值为 0（例如，贷款的未来值是 0）。
type  | 可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。

- 例子

  - 了解如何时间才能还清个人贷款

  假设您有一笔 2,500 美元的个人贷款，并同意每月付款 150 美元，年利率为 3%。
  使用函数 NPER(rate,PMT,PV)
  =NPER(3%/12,-150,2500)
  需要 17 个月和几天还清贷款。
  Rate 参数是 3%/12（每年付款 12 期，按月付款）。
  PMT 参数是-150。
  PV （现值） 参数是 2500年。

### FV

- FV返回根据定期固定付款和固定利率而定的投资的未来值
- 函数：FV(rate,nper,pmt,[pv],[type])

参数|说明
---|---
Rate   | 必需。 各期利率。
Nper    |必需。年金的付款总期数。
Pmt    |必需。 各期所应支付的金额，在整个年金期间保持不变。 通常 pmt 包括本金和利息，但不包括其他费用或税款。 如果省略 pmt，则必须包括 pv 参数。
pv    |可选。 现值，或一系列未来付款的当前值的累积和。 如果省略 pv，则假定其值为 0（零），并且必须包括 pmt 参数。
Type   | 可选。 数字 0 或 1，用以指定各期的付款时间是在期初还是期末。 如果省略 type，则假定其值为 0。

- 例子

  - 计算一段时间后您的储蓄总额是多少
  假设您的开户金额是 500 美元，每月存款 200 美元，利率为 1.5%，那么 10 个月后您的存款总额有多少？
  使用函数 FV(rate,NPER,PMT,PV)
  =FV(1.5%/12,10,-200,-500)
  在 10 个月后您必须 $2,517.57 节省。
  Rate 参数是 1.5%/12。
  NPER 参数是 10 （月份数）。
  PMT 参数是-200。
  PV （现值） 参数是-500。

## 参考

- [使用 Excel 公式计算还款和存款](https://support.office.com/zh-cn/article/%E4%BD%BF%E7%94%A8-Excel-%E5%85%AC%E5%BC%8F%E8%AE%A1%E7%AE%97%E8%BF%98%E6%AC%BE%E5%92%8C%E5%AD%98%E6%AC%BE-11cb708f-c137-4ef8-bcf3-5137aaeb4b20)
- [PMT function](https://support.office.com/en-us/article/PMT-function-0214da64-9a63-4996-bc20-214433fa6441)
- [PV function](https://support.office.com/en-us/article/PV-function-23879d31-0e02-4321-be01-da16e8168cbd)
- [NPER function](https://support.office.com/en-us/article/NPER-function-240535b5-6653-4d2d-bfcf-b6a38151d815)
- [FV](https://support.office.com/en-us/article/FV-function-2eef9f44-a084-4c61-bdd8-4fe4bb1b71b3)
